## Trait std::iter::Iterator

### æè¿°ï¼šæ­¤ä¸ºstd::iteræ¨¡å—çš„æ ¸å¿ƒï¼Œä¸€ä¸ªå¤„ç†è¿­ä»£å™¨çš„æ¥å£

æ­¤ä¸ºä¸»è¦çš„è¿­ä»£å™¨traitã€‚

### Associated Types æ¶‰åŠçš„ç±»å‹

type Item

æŒ‡ä»£è¢«è¿­ä»£å…ƒç´ çš„ç±»å‹ã€‚
    
### Required methods éœ€è¦å®ç°çš„æ–¹æ³•

fn next(&mut self) -> Option<Self::Item>

ä½¿è¿­ä»£å™¨å‰è¿›å¹¶è¿”å›ä¸‹ä¸€ä¸ªå€¼ã€‚

åœ¨è¿­ä»£ç»“æŸæ—¶è¿”å›Noneã€‚ä¸€äº›ä¸ªåˆ«è¿­ä»£å™¨ç”¨æ³•ä¼šä¸åœè¿­ä»£ï¼Œå› æ­¤ä¸æ–­è°ƒç”¨next()å¯èƒ½æ°¸è¿œä¸ä¼šè¿”å›ä¸€ä¸ªSome(Item):

```rust
let a = [1, 2, 3];

let mut iter = a.iter();

assert_eq!(Some(&1), iter.next());
assert_eq!(Some(&2), iter.next());
assert_eq!(Some(&3), iter.next());

// ... æœ€ç»ˆè¿­ä»£ç»“æŸæ—¶è¿”å›None.
assert_eq!(None, iter.next());

// æ›´å¤šçš„nextè°ƒç”¨å¯èƒ½æ°¸è¿œè¿”å›ä¸€ä¸ªNone.
assert_eq!(None, iter.next());
assert_eq!(None, iter.next());
```

***

### Provided methods æä¾›çš„æ–¹æ³•

fn size_hint(&self) -> (usize, Option<usize>)

è¿”å›ä¸€ä¸ªè¿­ä»£å™¨å‰©ä½™é•¿åº¦çš„è¾¹ç•Œå…ƒç»„ã€‚

ç‰¹åˆ«åœ°ï¼Œæ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä»£è¡¨ä¸‹ç•Œï¼Œç¬¬äºŒä¸ªå…ƒç´ ä»£è¡¨ä¸Šç•Œã€‚

ç¬¬äºŒä¸ªå…ƒç´ ä¸ºä¸€ä¸ªOption<usize>ï¼Œå¦‚æœå®ƒçš„å€¼ä¸ºNoneä»£è¡¨æ²¡æœ‰å·²çŸ¥çš„ä¸Šç•Œï¼Œæˆ–è€…ä¸Šç•Œçš„å€¼æ¯”usizeè¿˜å¤§ã€‚


### Implementation notes å®ç°ç¬”è®°

è¿­ä»£å™¨çš„å®ç°å¹¶ä¸å¼ºåˆ¶ç”Ÿæˆå£°æ˜æ•°é‡çš„å…ƒç´ ã€‚ä¸€ä¸ªæœ‰bugçš„è¿­ä»£å™¨ä¹Ÿè®¸ä¼šç”Ÿæˆæ¯”ä¸‹ç•Œè¿˜å°‘æˆ–è€…æ¯”ä¸Šç•Œè¿˜å¤šçš„å…ƒç´ ã€‚

size_hint()ä¸»è¦ç”¨ä½œä¼˜åŒ–ï¼Œåƒä¸ºè¿­ä»£å™¨å…ƒç´ é¢„ç•™ç©ºé—´ï¼Œä½†æ˜¯åœ¨unsafeä»£ç ä¸­çš„è¾¹ç•Œæ£€æŸ¥æ˜¯ä¸å—ä¿¡ä»»çš„ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ç°éœ€æä¾›ä¸€ä¸ªæ­£ç¡®çš„ä¼°é‡ï¼Œå¦åˆ™å°†è¿åtraitçš„åè®®

æ­¤æ–¹æ³•é»˜è®¤å®ç°è¿”å›(0, None)ï¼Œè¿™å¯¹ä»»æ„è¿­ä»£å™¨éƒ½æ˜¯æ­£ç¡®çš„ã€‚

#### Examples

åŸºç¡€ä¾‹å­ï¼š

```rust
let a = [1, 2, 3];
let iter = a.iter();

assert_eq!((3, Some(3)), iter.size_hint());
```

ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ï¼š

```rust
let iter = (0..10).filter(|x| x % 2 == 0);
```

***
    
fn count(self) -> usize

æ¶ˆè´¹è¿­ä»£å™¨ï¼Œè®¡ç®—è¿­ä»£æ¬¡æ•°å¹¶è¿”å›ã€‚

è¿™ä¸ªæ–¹æ³•ä¼šé‡å¤è°ƒç”¨nextæ–¹æ³•ç›´è‡³é‡åˆ°Noneï¼Œç„¶åè¿”å›å®ƒâ€˜çœ‹è§â€™Someå€¼çš„æ¬¡æ•°ã€‚æ³¨æ„å³ä½¿è¿­ä»£å™¨ä¸€ä¸ªå…ƒç´ éƒ½ä¸åŒ…å«ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¿…é¡»è‡³å°‘è°ƒç”¨ä¸€æ¬¡nextã€‚

### Overflow Behavior æº¢å‡ºè¡Œä¸º

countæ–¹æ³•å¹¶ä¸é˜²æ­¢æº¢å‡ºï¼Œæ‰€ä»¥å¯¹å…ƒç´ æ•°é‡è¶…è¿‡usize::MAXçš„è¿­ä»£å™¨è¿›è¡Œè®¡æ•°ä¼šé€ æˆé”™è¯¯ä»¥åŠç¨‹åºpanicã€‚è‹¥å¯ç”¨äº†æ–­è¨€è°ƒè¯•ï¼Œé‚£ä¹ˆå¯ä»¥ä¿è¯å‡ºç°ä¸€ä¸ªpanicã€‚

### Panics ä¸¥é‡é”™è¯¯

æ­¤å‡½æ•°åœ¨è¿­ä»£å™¨å…ƒç´ æ•°é‡è¶…è¿‡usize::MAXæ—¶ä¹Ÿè®¸ä¼šé€ æˆpanicã€‚

#### Examples

åŸºæœ¬ç”¨æ³•ï¼š

```rust
let a = [1, 2, 3];
assert_eq!(a.iter().count(), 3);

let a = [1, 2 ,3 ,4 ,5];
assert_eq!(a.iter().count(), 5);
```    

***
    
fn last(self) -> Option<Self::Item>

æ¶ˆè´¹è¿­ä»£å™¨ï¼Œè¿”å›å…¶æœ«å°¾å…ƒç´ ã€‚

æ­¤æ–¹æ³•è¯„ä¼°è¿­ä»£å™¨çŸ¥é“è¿­ä»£å™¨è¿”å›Noneã€‚æ­¤è¿‡ç¨‹ä¸­ï¼Œå®ƒå°†è¿½è¸ªå½“å‰çš„å…ƒç´ ï¼Œå½“è¿­ä»£å™¨è¿”å›Noneåï¼Œlastè¿”å›å®ƒçœ‹åˆ°çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚

#### Examples

åŸºç¡€ç”¨æ³•ï¼š

```rust
let a = [1, 2, 3];
assert_eq!(a.iter().last(), Some(&3));
```

***
    
fn nth(&mut self, n: usize) -> Option<Self::Item>

è¿”å›è¿­ä»£å™¨ä¸­ç¬¬nä¸ªå…ƒç´ ã€‚

åƒå¤§å¤šæ•°ç´¢å¼•æ“ä½œä¸€æ ·ï¼Œå®ƒä»0å¼€å§‹è®¡æ•°ï¼Œæ‰€ä»¥nth(0)è¿”å›ç¬¬ä¸€ä¸ªå€¼ï¼Œnth(1)ä¸ºç¬¬äºŒä¸ªã€‚

æ³¨æ„æ‰€æœ‰è¢«éå†è¿‡çš„å…ƒç´ ï¼Œä»¥åŠæœ€ç»ˆè¢«è¿”å›çš„å…ƒç´ ï¼Œä¼šè¢«è¿­ä»£å™¨æ‰€æ¶ˆè´¹ã€‚è¿™æ„å‘³ç€è¢«éå†è¿‡çš„å…ƒç´ ä¼šè¢«ä¸¢å¼ƒï¼Œå› æ­¤ï¼Œåœ¨åŒä¸€ä¸ªè¿­ä»£å™¨ä¸Šè°ƒç”¨nth(0)å¤šæ¬¡ä¼šè¿”å›ä¸åŒçš„å…ƒç´ ã€‚

```rust
let a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let mut iter = a.iter();

iter.nth(6).unwrap();
println!("{:?}", iter);
```

æ­¤æ®µä»£ç è¾“å‡ºä¸º Iter([8, 9, 10]),ä¹Ÿå°±æ˜¯è¯´ï¼Œè¢«éå†çš„å‰äº”ä¸ªå…ƒç´ ä»¥åŠè¿”å›çš„ç¬¬å…­ä¸ªå…ƒç´ å‡è¢«æ¶ˆè´¹ä¸”ä¸¢å¼ƒã€‚

å¦‚æœnå¤§äºç­‰äºè¿­ä»£å™¨çš„é•¿åº¦ï¼Œnth()ä¼šè¿”å›Noneã€‚

#### Examples

åŸºæœ¬ç”¨æ³•ï¼š

```rust
let a = [1, 2, 3];
assert_eq!(a.iter().nth(1), Some(&2));
```

è°ƒç”¨å¤šæ¬¡é€ æˆæ¶ˆè´¹ï¼š

```rust
let a = [1, 2, 3];

let mut iter = a.iter();

assert_eq!(iter.nth(1), Some(&2));
assert_eq!(iter.nth(1), None);
```

è¶…å‡ºç´¢å¼•èŒƒå›´è¿”å›ä¸€ä¸ªNoneï¼š

```rust
let a = [1, 2, 3];
assert_eq!(a.iter().nth(10), None);
```

***

fn step_by(self, step: usize) -> StepBy<Self>

åˆ›å»ºä¸€ä¸ªæŒ‡å‘åŒä¸€ç‚¹çš„è¿­ä»£å™¨ï¼Œä½†æ˜¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­æŒ‰ç…§ç»™å®šçš„æ­¥é•¿è¿›è¡Œè¿­ä»£ã€‚

Note 1: æ— è®ºç»™å®šçš„æ­¥é•¿ä¸ºå¤šå°‘ï¼Œè¿­ä»£å™¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ€»æ˜¯ä¼šè¢«è¿”å›ã€‚

Note 2: è¢«å¿½ç•¥çš„å…ƒç´ è¢«æ¨å‡ºçš„æ—¶é—´ä¸å›ºå®šã€‚StepByè¡¨ç°å¾—åƒæ˜¯ä¸‹é¢çš„åºåˆ—ï¼š

**next() -> nth(step-1) -> nth(step-1) -> ...**

ä½†æ˜¯åˆèƒ½åƒä¸‹é¢çš„åºåˆ—:

**advance_n_and_return_first(step) -> advance_n_and_return_first(step) -> ...**

ç”¨å“ªç§æ–¹æ³•å–å†³äºè¿­ä»£å™¨ä¸ºæ€§èƒ½çš„è€ƒé‡ã€‚ç¬¬äºŒä¸ªæ–¹æ³•ä¼šæå‰æ¨è¿›è¿­ä»£å™¨å¹¶æ¶ˆè´¹æ›´å¤šå…ƒç´ ã€‚

æˆ‘ä»¬æ‰€è¯´çš„advance_n_and_return_firstç±»ä¼¼äºä¸‹é¢çš„å®ç°ï¼š

```rust
fn advance_n_and_return_first<I>(iter: &mut I, total_step: usize) -> Option<I::Item>
where I: Iterator
{
	let next = iter.next();
	if total_step > 1 {
		iter.nth(total_step - 2);
	}
	next
}
```

#### Panics

ç»™å®šæ­¥é•¿ä¸º0æ—¶ï¼Œæ­¤æ–¹æ³•ä¼španicã€‚

#### Examples

åŸºæœ¬ç”¨æ³•ï¼š

```rust
let a = [0, 1, 2, 3, 4, 5];
let mut iter = a.iter().step_by(2);

assert_eq!(iter.next(), Some(&0));
assert_eq!(iter.next(), Some(&2));
assert_eq!(iter.next(), Some(&4));
assert_eq!(iter.next(), None);
```

***

fn chain<U>(self, other: U) -> Chain<Self, <U as IntoIterator>::IntoIter>
where U: IntoIterator<Item = Self::Item>

å–ä¸¤ä¸ªè¿­ä»£å™¨å¹¶åˆ›å»ºä¸€ä¸ªè¦†ç›–ä¸¤ä¸ªè¿­ä»£å™¨ä¸ä¸€ä¸ªç›¸åŒåºåˆ—çš„æ–°è¿­ä»£å™¨ã€‚

chain()ä¼šè¿”å›ä¸€ä¸ªæ–°è¿­ä»£å™¨ï¼Œå®ƒçš„é¦–æ¬¡è¿­ä»£éå†ä½äºç¬¬ä¸€ä¸ªè¿­ä»£å™¨ä¸­çš„å€¼ï¼Œç„¶åéå†ç¬¬äºŒä¸ªè¿­ä»£å™¨ã€‚

æ¢å¥è¯è¯´ï¼Œå®ƒå°†ä¸¤ä¸ªè¿­ä»£å™¨é“¾æ¥ä¸ºä¸€ä¸ªé”é“¾ğŸ”—ã€‚

[once](https://doc.rust-lang.org/std/iter/fn.once.html)æ–¹æ³•å¸¸ç”¨æ¥å°†ä¸€ä¸ªå•ç‹¬çš„å€¼é€‚é…åˆ°ä¸€ä¸ªå…¶å®ƒç±»å‹çš„è¿­ä»£é“¾ä¸­ã€‚

#### Examples

åŸºæœ¬ç”¨æ³•ï¼š

```rust
let a1 = [1, 2, 3];
let a2 = [4, 5, 6];

let mut iter = a1.iter().chain(a2.iter());
```

ç”±äºchain()çš„å‚æ•°ä½¿ç”¨IntoIteratorï¼Œæˆ‘ä»¬å¯ä¼ é€’ä»»ä½•å¯è½¬ä¸ºIteratorçš„ä¸œè¥¿ï¼Œä¸ä»…æ˜¯Iteratoræœ¬èº«ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œslices(&[T])å®ç°äº†IntoIteratorï¼Œæ‰€ä»¥å¯ç›´æ¥ä¼ é€’ç»™chain()ã€‚

```rust

```

### åŸæ–‡åœ°å€

[doc.rust-lang.org](https://doc.rust-lang.org/std/iter/trait.Iterator.html)